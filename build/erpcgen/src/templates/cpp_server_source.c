/*
 * AUTOMATICALLY GENERATED FILE - DO NOT EDIT
 */

// Generated from /home/patrick/erpc/server/ra_wifi_erpc_server/r_wifi_erpc_server/erpc/erpcgen/src/templates/cpp_server_source.template
extern const char * const kCppServerSource;

const char * const kCppServerSource = 
"{% set source = \"server\" >%}\n"
"{% if mlComment != \"\"%}\n"
"{$mlComment}\n"
"\n"
"{% endif %}\n"
"{$commonHeader()}\n"
"\n"
"#include \"{$serverCppHeaderName}\"\n"
"#if ERPC_ALLOCATION_POLICY == ERPC_ALLOCATION_POLICY_DYNAMIC\n"
"#include <new>\n"
"#include \"erpc_port.h\"\n"
"#endif\n"
"#include \"erpc_manually_constructed.hpp\"\n"
"\n"
"{$checkVersion()}\n"
"{$>checkCrc()}\n"
"using namespace erpc;\n"
"using namespace std;\n"
"{$usingNamespace() >}\n"
"\n"
"#if ERPC_NESTED_CALLS_DETECTION\n"
"extern bool nestingDetection;\n"
"#endif\n"
"\n"
"{$generateCrcVariable()}\n"
"{$> setSharedMemAddresses()}\n"
"{$> constantsDefinitions(consts)}\n"
"{$> symbolHeader(group.symbolsMap.symbolsToServer, \"deserial\", \"def\")}\n"
"{$> symbolSource(group.symbolsMap.symbolsToServer, \"deserial\", \"def\")}\n"
"{$> symbolHeader(group.symbolsMap.symbolsToClient, \"serial\", \"def\")}\n"
"{$> symbolSource(group.symbolsMap.symbolsToClient, \"serial\", \"def\")}\n"
"{$> symbolFreeSpaceHeader(group.symbolsMap.symbolsServerFree, \"def\")}\n"
"{$> symbolFreeSpaceSource(group.symbolsMap.symbolsServerFree, \"def\")}\n"
"{$> symbolHeader(group.symbolsMap.symbolsToServer, \"deserial\", \"noSharedMem\")}\n"
"{$> symbolSource(group.symbolsMap.symbolsToServer, \"deserial\", \"noSharedMem\")}\n"
"{$> symbolHeader(group.symbolsMap.symbolsToClient, \"serial\", \"noSharedMem\")}\n"
"{$> symbolSource(group.symbolsMap.symbolsToClient, \"serial\", \"noSharedMem\")}\n"
"{$> symbolFreeSpaceHeader(group.symbolsMap.symbolsServerFree, \"noSharedMem\")}\n"
"{$> symbolFreeSpaceSource(group.symbolsMap.symbolsServerFree, \"noSharedMem\")}\n"
"{% def serverShimCode(iface, handler, fn, serverIDName, functionIDName) ------------------------- serverShimCode(fn, serverIDName, functionIDName) %}\n"
"{% set serverIndent = \"\" >%}\n"
"{% if (fn.isReturnValue || fn.isSendValue) && generateErrorChecks %}\n"
"    erpc_status_t err = kErpcStatus_Success;\n"
"\n"
"{% endif -- isReturnValue || isSendValue %}\n"
"{% for param in fn.parameters %}\n"
"    {% if param.isFunction %}{% if param.ifaceScope != \"\"%}{$param.ifaceScope}{% else %}{$iface.name}{% endif %}_interface::{% endif %}{$param.variable}{% if param.isNullParam %} = NULL{% endif %};\n"
"{%  if !empty(param.nullVariable) %}\n"
"    {$param.nullVariable} = NULL;\n"
"{%  endif %}\n"
"{%  if !param.shared %}\n"
"{%   if param.isNullable == false && param.direction != OutDirection %}\n"
"{$> addIndent(\"    \", allocMem(param.mallocServer))}\n"
"{%   endif -- !param.isNullable && param.direction != OutDirection %}\n"
"{%  endif -- shared %}\n"
"{% endfor -- param %}\n"
"{% if fn.needNullVariableOnServer %}\n"
"    bool isNull;\n"
"{% endif -- needNullVariableOnServer %}\n"
"{% if fn.needTempVariableServerI32 %}\n"
"    int32_t _tmp_local_i32;\n"
"{% endif %}\n"
"{% if fn.needTempVariableServerU16 %}\n"
"    uint16_t _tmp_local_u16;\n"
"{% endif %}\n"
"{% if fn.returnValue.type.isNotVoid %}\n"
"    {$fn.returnValue.resultVariable}{% if fn.returnValue.isNullReturnType %} = NULL{% endif %};\n"
"{% endif %}\n"
"{% if fn.isReturnValue || fn.isSendValue  %}\n"
"\n"
"{% endif %}\n"
"    // startReadMessage() was already called before this shim was invoked.\n"
"\n"
"{% if fn.isSendValue %}\n"
"{%  for param in fn.parameters if (param.serializedDirection == \"\" || param.serializedDirection == OutDirection || param.referencedName != \"\") %}\n"
"{%   if param.isNullable %}\n"
"{$addIndent(\"    \", f_paramIsNullableDecode(param))}\n"
"\n"
"{%   else -- notNullable %}\n"
"{%    if param.direction != OutDirection %}\n"
"{$addIndent(\"    \", param.coderCall.decode(param.coderCall))}\n"
"\n"
"{%    endif -- param != OutDirection %}\n"
"{%   endif -- isNullable %}\n"
"{%  endfor -- parametersToServer %}\n"
"{% endif -- isSendValue %}\n"
"{% for param in fn.parametersToClient %}\n"
"{%  if !param.shared %}\n"
"{%   if param.isNullable == false && param.direction == OutDirection && empty(param.mallocServer) == false %}\n"
"{$> addIndent(\"    \", allocMem(param.mallocServer))}\n"
"\n"
"{%   endif -- !param.isNullable && param.direction == OutDirection %}\n"
"{%  endif -- shared %}\n"
"{% endfor -- param %}\n"
"{% if (fn.isReturnValue || fn.isSendValue) && generateErrorChecks %}\n"
"{%  set serverIndent = \"    \" >%}\n"
"    err = codec->getStatus();\n"
"    if (err == kErpcStatus_Success)\n"
"    {\n"
"{% endif -- generateErrorChecks %}\n"
"{$serverIndent}    // Invoke the actual served function.\n"
"#if ERPC_NESTED_CALLS_DETECTION\n"
"{$serverIndent}    nestingDetection = true;\n"
"#endif\n"
"{% if serverIDName == \"serviceID\" %}\n"
"{%  for callbackFunction in fn.functions %}\n"
"{$serverIndent}    {% if loop.first == false %}else {% endif %}if (({$serverIDName} == {$callbackFunction.serviceId}) && ({$functionIDName} == {$callbackFunction.id}))\n"
"{$serverIndent}    {\n"
"{$serverIndent}        m_handler->{$callbackFunction.serverPrototype}\n"
"{$serverIndent}    }\n"
"{%  endfor -- callbackFunction in callbackType.functions %}\n"
"{% else -- serverIDName == \"serviceID\" %}\n"
"{$serverIndent}    {$fn.serverPrototype}\n"
"{% endif --serverIDName == \"serviceID\" %}\n"
"#if ERPC_NESTED_CALLS_DETECTION\n"
"{$serverIndent}    nestingDetection = false;\n"
"#endif\n"
"{% if fn.isReturnValue %}\n"
"\n"
"{$serverIndent}    // preparing MessageBuffer for serializing data\n"
"{$serverIndent}    {% if generateErrorChecks %}err = {% endif %}messageFactory->prepareServerBufferForSend(codec->getBufferRef(), transport->reserveHeaderSize());\n"
"{%  if generateErrorChecks %}\n"
"    }\n"
"\n"
"    if (err == kErpcStatus_Success)\n"
"    {\n"
"{%  endif -- generateErrorChecks %}\n"
"{$serverIndent}    // preparing codec for serializing data\n"
"{$serverIndent}    codec->reset(transport->reserveHeaderSize());\n"
"\n"
"{$serverIndent}    // Build response message.\n"
"{$serverIndent}    codec->startWriteMessage(message_type_t::kReplyMessage, {$serverIDName}, {$functionIDName}, sequence);\n"
"{%  for param in fn.parametersToClient if (param.serializedDirection == \"\" || param.serializedDirection == InDirection || param.referencedName != \"\") %}\n"
"\n"
"{%   if param.isNullable %}\n"
"{$serverIndent}    if ({% if source == \"server\" && empty(param.nullVariable) == false %}_{% endif %}{$param.name} != NULL)\n"
"{$serverIndent}    {\n"
"{$addIndent(serverIndent & \"        \", param.coderCall.encode(param.coderCall))}\n"
"{$serverIndent}    }\n"
"{%   else -- isNullable %}\n"
"{$addIndent(serverIndent & \"    \", param.coderCall.encode(param.coderCall))}\n"
"{%   endif -- isNullable %}\n"
"{%  endfor -- parametersToClient %}\n"
"{%  if fn.returnValue.type.isNotVoid %}\n"
"\n"
"{%   if fn.returnValue.isNullable %}\n"
"{$addIndent(serverIndent & \"    \", f_paramIsNullableEncode(fn.returnValue))}\n"
"{%   else -- isNullable %}\n"
"{$addIndent(serverIndent & \"    \", fn.returnValue.coderCall.encode(fn.returnValue.coderCall))}\n"
"{%   endif -- isNullable %}\n"
"{%  endif -- notVoid %}\n"
"{%  if generateErrorChecks %}\n"
"\n"
"        err = codec->getStatus();\n"
"{%  endif generateErrorChecks %}\n"
"{% endif -- isReturnValue %}\n"
"{% if (fn.isReturnValue || fn.isSendValue) && generateErrorChecks %}\n"
"    }\n"
"\n"
"{% endif -- fn.isReturnValue || fn.isSendValue %}\n"
"{% for param in fn.paramsToFree %}\n"
"{$> addIndent(\"    \", param.coderCall.freeingCall(param.coderCall))}\n"
"{$> addIndent(\"    \", param.firstFreeingCall1.firstFreeingCall(param.firstFreeingCall1))}\n"
"\n"
"{% endfor -- parameters %}\n"
"{% if fn.returnValue.type.isNotVoid %}\n"
"{%  set needFreeingCall = fn.returnValue.coderCall.freeingCall(fn.returnValue.coderCall) %}\n"
"{%  set needFirstFreeingCall = fn.returnValue.firstFreeingCall1.firstFreeingCall(fn.returnValue.firstFreeingCall1) %}\n"
"{%  if empty(needFreeingCall) == false || empty(needFirstFreeingCall) == false %}\n"
"{$> addIndent(\"    \", needFreeingCall)}\n"
"{$> addIndent(\"    \", needFirstFreeingCall)}\n"
"\n"
"{%  endif -- !empty(needFreeingCall) || !empty(needFirstFreeingCall) %}\n"
"{% endif -- notVoid %}\n"
"{% if (fn.isReturnValue || fn.isSendValue) && generateErrorChecks %}\n"
"    return err;\n"
"{% else %}\n"
"    return codec->getStatus();\n"
"{% endif %}\n"
"{% enddef --------------------------------------------------------------------------------- serverShimCode(fn, serverIDName, functionIDName) %}\n"
"{% for iface in group.interfaces %}\n"
"{%  for cb in iface.callbacksInt  if (count(cb.callbacks) > 1) %}\n"
"// Common function for serializing and deserializing callback functions of same type.\n"
"static erpc_status_t {$iface.interfaceClassName}_{$cb.name}_shim({$iface.interfaceClassName} *m_handler, uint32_t serviceID, uint32_t functionID, {$codecClass} * codec, MessageBufferFactory *messageFactory, Transport * transport, uint32_t sequence);\n"
"{%  endfor %}\n"
"{% endfor %}\n"
"{% for iface in group.interfaces %}\n"
"{%  for cb in iface.callbacksInt if (count(cb.callbacks) > 1) %}\n"
"\n"
"// Common function for serializing and deserializing callback functions of same type.\n"
"static erpc_status_t {$iface.interfaceClassName}_{$cb.name}_shim({$iface.interfaceClassName} *m_handler, uint32_t serviceID, uint32_t functionID, {$codecClass} * codec, MessageBufferFactory *messageFactory, Transport * transport, uint32_t sequence)\n"
"{\n"
"{$ serverShimCode(iface, \"m_handler\", cb.callbacksData, \"serviceID\", \"functionID\") >}\n"
"}\n"
"{%  endfor %}\n"
"{% endfor %}\n"
"{% for iface in group.interfaces -- service subclass method impl %}\n"
"\n"
"{$iface.serviceClassName}::{$iface.serviceClassName}({$iface.interfaceClassName} *_{$iface.interfaceClassName})\n"
"    : erpc::Service({$iface.interfaceClassName}::m_serviceId)\n"
"    , m_handler(_{$iface.interfaceClassName})\n"
"{\n"
"}\n"
"\n"
"{$iface.serviceClassName}::~{$iface.serviceClassName}()\n"
"{\n"
"}\n"
"\n"
"// return service interface handler.\n"
"{$iface.interfaceClassName}* {$iface.serviceClassName}::getHandler(void)\n"
"{\n"
"    return m_handler;\n"
"}\n"
"\n"
"// Call the correct server shim based on method unique ID.\n"
"erpc_status_t {$iface.serviceClassName}::handleInvocation(uint32_t methodId, uint32_t sequence, Codec * codec, MessageBufferFactory *messageFactory, Transport * transport)\n"
"{\n"
"    erpc_status_t erpcStatus;\n"
"{%  if codecClass != \"Codec\" %}\n"
"    {$codecClass} *_codec = static_cast<{$codecClass} *>(codec);\n"
"{%   endif %}\n"
"    switch (methodId)\n"
"    {\n"
"{%  for fn in iface.functions %}\n"
"        case {$iface.interfaceClassName}::{$getClassFunctionIdName(fn)}:\n"
"        {\n"
"            erpcStatus = {$fn.name}_shim({%if codecClass == \"Codec\" %}codec{% else %}_codec{% endif %}, messageFactory, transport, sequence);\n"
"            break;\n"
"        }\n"
"\n"
"{%  endfor -- fn %}\n"
"        default:\n"
"        {\n"
"            erpcStatus = kErpcStatus_InvalidArgument;\n"
"            break;\n"
"        }\n"
"    }\n"
"\n"
"    return erpcStatus;\n"
"}\n"
"{%  for fn in iface.functions %}\n"
"\n"
"// Server shim for {$fn.name} of {$iface.name} interface.\n"
"erpc_status_t {$iface.serviceClassName}::{$fn.name}_shim({$codecClass} * codec, MessageBufferFactory *messageFactory, Transport * transport, uint32_t sequence)\n"
"{\n"
"{% if fn.isCallback %}\n"
"    return {$iface.interfaceClassName}_{$fn.callbackFNameNoGroup}_shim(m_handler, {$iface.interfaceClassName}::m_serviceId, {$iface.interfaceClassName}::{$getClassFunctionIdName(fn)}, codec, messageFactory, transport, sequence);\n"
"{% else -- fn.isCallback >%}\n"
"{$ serverShimCode(iface, \"m_handler\", fn, iface.interfaceClassName & \"::m_serviceId\", iface.interfaceClassName & \"::\" & getClassFunctionIdName(fn)) >}\n"
"{% endif -- fn.isCallback >%}\n"
"}\n"
"{%  endfor -- fn %}\n"
"{% endfor -- iface %}\n"
;

